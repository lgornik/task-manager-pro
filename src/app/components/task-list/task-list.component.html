<!-- <div>
  <h2>Task List z kategoriami</h2>
  
  @if (tasksWithCategories$ | async; as tasks) {
    <ul>
      @for (task of tasks; track task.id) {
        <li>
          {{ task.title }}
          @if (task.category) {
            <span [style.color]="task.category.color">
              {{ task.category.icon }} {{ task.category.name }}
            </span>
          }
        </li>
      }
    </ul>
  }

  <h3>Statystyki kategorii</h3>
  @if (categoryStats$ | async; as stats) {
    <ul>
      @for (stat of stats; track stat.categoryId) {
        <li>
          @if (stat.category) {
            {{ stat.category.icon }} {{ stat.category.name }}
          } @else {
            Bez kategorii
          }
          - Total: {{ stat.total }}, Active: {{ stat.active }}
        </li>
      }
    </ul>
  }
</div> -->

<div class="container">
  <h1>Task Manager Pro üìã</h1>

  <!-- Error message -->
  @if (error$ | async; as error) {
  <div class="error">{{ error }}</div>
  }

  <!-- Loading indicator -->
  @if (loading$ | async) {
  <div class="loading">≈Åadowanie...</div>
  }

  <!-- Add task form -->
  <div class="add-task">
    <input type="text" [(ngModel)]="newTaskTitle" placeholder="Nowe zadanie..." (keyup.enter)="addTask()" />

    <select [(ngModel)]="newTaskPriority">
      <option value="low">Niski</option>
      <option value="medium">≈öredni</option>
      <option value="high">Wysoki</option>
    </select>

    <!-- NOWE: Wyb√≥r kategorii -->
    <select [(ngModel)]="newTaskCategoryId">
      <option [value]="null">Bez kategorii</option>
      @for (category of categories$ | async; track category.id) {
      <option [value]="category.id">
        {{ category.icon }} {{ category.name }}
      </option>
      }
    </select>

    <button (click)="addTask()">Dodaj</button>
  </div>

  <!-- Stats -->
  @if (count$ | async; as count) {
  <div class="stats">
    <span>Wszystkich: {{ count.total }}</span>
    <span>Aktywnych: {{ count.active }}</span>
    <span>Uko≈Ñczonych: {{ count.completed }}</span>
  </div>
  }

  <!-- Filters -->
  <div class="filters">
    <button [class.active]="(filter$ | async) === 'all'" (click)="setFilter('all')">
      Wszystkie
    </button>
    <button [class.active]="(filter$ | async) === 'active'" (click)="setFilter('active')">
      Aktywne
    </button>
    <button [class.active]="(filter$ | async) === 'completed'" (click)="setFilter('completed')">
      Uko≈Ñczone
    </button>
  </div>

  <!-- Task list -->
  <ul class="task-list">
    @for (task of tasks$ | async; track task.id) {
    <li [class.completed]="task.completed">
      <input type="checkbox" [checked]="task.completed" (change)="toggleTask(task.id)" />
      <div class="task-content">
        <span class="task-title">{{ task.title }}</span>
        <span class="priority priority-{{ task.priority }}">
          {{ task.priority }}
        </span>
      </div>
      <button class="delete-btn" (click)="deleteTask(task.id)">
        üóëÔ∏è
      </button>
    </li>
    } @empty {
    <li class="empty">Brak zada≈Ñ</li>
    }
  </ul>

  <!-- Bulk actions -->
  <div class="bulk-actions">
    <button (click)="deleteCompleted()">Usu≈Ñ uko≈Ñczone</button>
    <button (click)="toggleAll(true)">Zaznacz wszystkie</button>
    <button (click)="toggleAll(false)">Odznacz wszystkie</button>
  </div>
</div>